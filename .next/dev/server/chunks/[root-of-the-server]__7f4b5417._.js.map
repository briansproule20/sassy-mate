{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/briansproule/Coding%20Projects/sassy-mate/app/api/witnesses/leaderboard/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport const revalidate = 0; // Disable caching for real-time data\n\nexport async function GET() {\n  try {\n    const { Redis } = await import(\"@upstash/redis\");\n    \n    // Initialize Redis using environment variables\n    const redis = Redis.fromEnv();\n    \n    // Fetch all leaders from Redis sorted set\n    const leaders = await redis.zrange(\"leaderboard\", 0, -1, { rev: true, withScores: true });\n\n    // Transform the data\n    const leaderData = [];\n    for (let i = 0; i < leaders.length; i += 2) {\n      const name = leaders[i] as string;\n      const points = parseInt(leaders[i + 1] as string);\n      \n      // Get additional user data\n      const userData = await redis.hgetall(`user:${name}`);\n      \n      leaderData.push({\n        id: name,\n        name,\n        points,\n        lastSeen: userData?.lastSeen || new Date().toISOString(),\n        petitionCount: userData?.petitionCount || 0,\n        rank: Math.floor(i / 2) + 1,\n      });\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: leaderData,\n    });\n  } catch (error) {\n    console.error(\"Failed to fetch leaderboard from Redis:\", error);\n    return NextResponse.json({\n      success: false,\n      error: \"Failed to fetch leaderboard\",\n    }, { status: 500 });\n  }\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,aAAa,GAAG,qCAAqC;AAE3D,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG;QAElB,+CAA+C;QAC/C,MAAM,QAAQ,MAAM,OAAO;QAE3B,0CAA0C;QAC1C,MAAM,UAAU,MAAM,MAAM,MAAM,CAAC,eAAe,GAAG,CAAC,GAAG;YAAE,KAAK;YAAM,YAAY;QAAK;QAEvF,qBAAqB;QACrB,MAAM,aAAa,EAAE;QACrB,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,KAAK,EAAG;YAC1C,MAAM,OAAO,OAAO,CAAC,EAAE;YACvB,MAAM,SAAS,SAAS,OAAO,CAAC,IAAI,EAAE;YAEtC,2BAA2B;YAC3B,MAAM,WAAW,MAAM,MAAM,OAAO,CAAC,CAAC,KAAK,EAAE,MAAM;YAEnD,WAAW,IAAI,CAAC;gBACd,IAAI;gBACJ;gBACA;gBACA,UAAU,UAAU,YAAY,IAAI,OAAO,WAAW;gBACtD,eAAe,UAAU,iBAAiB;gBAC1C,MAAM,KAAK,KAAK,CAAC,IAAI,KAAK;YAC5B;QACF;QAEA,OAAO,iKAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,OAAO,iKAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;QACT,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF","debugId":null}}]
}