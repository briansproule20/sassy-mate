{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/briansproule/Coding%20Projects/sassy-mate/app/api/witnesses/leaderboard/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport const revalidate = 0; // Disable caching for real-time data\n\nexport async function GET() {\n  // Only use Redis in production\n  if (process.env.KV_REST_API_URL && process.env.KV_REST_API_TOKEN) {\n    try {\n      const { kv } = await import(\"@vercel/kv\");\n      \n      // Fetch all leaders from Redis sorted set\n      const leaders = await kv.zrevrange(\"leaderboard\", 0, -1, {\n        withScores: true,\n      });\n\n      // Transform the data\n      const leaderData = [];\n      for (let i = 0; i < leaders.length; i += 2) {\n        const name = leaders[i] as string;\n        const points = leaders[i + 1] as number;\n        \n        // Get additional user data\n        const userData = await kv.hgetall(`user:${name}`);\n        \n        leaderData.push({\n          id: name,\n          name,\n          points,\n          lastSeen: userData?.lastSeen || new Date().toISOString(),\n          petitionCount: userData?.petitionCount || 0,\n        });\n      }\n\n      return NextResponse.json({\n        success: true,\n        data: leaderData,\n      });\n    } catch (error) {\n      console.error(\"Failed to fetch leaderboard from Redis:\", error);\n    }\n  }\n  \n  // Return empty array for local development\n  return NextResponse.json({\n    success: true,\n    data: [],\n    message: \"Redis not configured - using client-side storage\",\n  });\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,aAAa,GAAG,qCAAqC;AAE3D,eAAe;IACpB,+BAA+B;IAC/B,IAAI,QAAQ,GAAG,CAAC,eAAe,IAAI,QAAQ,GAAG,CAAC,iBAAiB,EAAE;QAChE,IAAI;YACF,MAAM,EAAE,EAAE,EAAE,GAAG;YAEf,0CAA0C;YAC1C,MAAM,UAAU,MAAM,GAAG,SAAS,CAAC,eAAe,GAAG,CAAC,GAAG;gBACvD,YAAY;YACd;YAEA,qBAAqB;YACrB,MAAM,aAAa,EAAE;YACrB,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,KAAK,EAAG;gBAC1C,MAAM,OAAO,OAAO,CAAC,EAAE;gBACvB,MAAM,SAAS,OAAO,CAAC,IAAI,EAAE;gBAE7B,2BAA2B;gBAC3B,MAAM,WAAW,MAAM,GAAG,OAAO,CAAC,CAAC,KAAK,EAAE,MAAM;gBAEhD,WAAW,IAAI,CAAC;oBACd,IAAI;oBACJ;oBACA;oBACA,UAAU,UAAU,YAAY,IAAI,OAAO,WAAW;oBACtD,eAAe,UAAU,iBAAiB;gBAC5C;YACF;YAEA,OAAO,iKAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,MAAM;YACR;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2CAA2C;QAC3D;IACF;IAEA,2CAA2C;IAC3C,OAAO,iKAAY,CAAC,IAAI,CAAC;QACvB,SAAS;QACT,MAAM,EAAE;QACR,SAAS;IACX;AACF","debugId":null}}]
}