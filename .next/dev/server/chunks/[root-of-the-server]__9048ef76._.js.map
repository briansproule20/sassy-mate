{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/briansproule/Coding%20Projects/sassy-mate/app/api/teams/cavs/next-game/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nconst NBA_API_BASE =\n  process.env.NEXT_PUBLIC_NBA_API_BASE || \"https://api.balldontlie.io/v1\";\nconst NBA_API_KEY = process.env.NBA_API_KEY;\n\nlet cachedCavsId: number | null = null;\n\nexport const revalidate = 300; // Cache for 5 minutes\n\nexport async function GET() {\n  try {\n    // Get Cavs team ID if not cached\n    if (!cachedCavsId) {\n      const teamRes = await fetch(`${NBA_API_BASE}/teams?search=Cavaliers`, {\n        headers: {\n          Authorization: NBA_API_KEY || \"\",\n        },\n      });\n      if (!teamRes.ok) throw new Error(\"Failed to fetch team\");\n      const teamData = await teamRes.json();\n      if (teamData.data && teamData.data.length > 0) {\n        cachedCavsId = teamData.data[0].id;\n      } else {\n        throw new Error(\"Cavs not found\");\n      }\n    }\n\n    const today = new Date().toISOString().split(\"T\")[0];\n\n    // Fetch next game\n    const gamesRes = await fetch(\n      `${NBA_API_BASE}/games?team_ids[]=${cachedCavsId}&start_date=${today}&per_page=1`,\n      {\n        headers: {\n          Authorization: NBA_API_KEY || \"\",\n        },\n      }\n    );\n\n    if (!gamesRes.ok) {\n      throw new Error(\"Failed to fetch games\");\n    }\n\n    const gamesData = await gamesRes.json();\n\n    if (!gamesData.data || gamesData.data.length === 0) {\n      return NextResponse.json({\n        success: true,\n        data: null,\n        message: \"No upcoming games found\",\n      });\n    }\n\n    const game = gamesData.data[0];\n    const gameDate = new Date(game.date);\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        id: game.id,\n        date: game.date,\n        home_team: game.home_team?.full_name || \"TBD\",\n        visitor_team: game.visitor_team?.full_name || \"TBD\",\n        opponent:\n          game.home_team?.id === cachedCavsId\n            ? game.visitor_team?.full_name\n            : game.home_team?.full_name,\n        is_home: game.home_team?.id === cachedCavsId,\n        status: game.status || \"Scheduled\",\n        countdown_seconds: Math.max(\n          0,\n          Math.floor((gameDate.getTime() - Date.now()) / 1000)\n        ),\n      },\n    });\n  } catch (error) {\n    console.error(\"Cavs next game API error:\", error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: \"Failed to fetch next game\",\n        data: null,\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,eACJ,qEAAwC;AAC1C,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,eAA8B;AAE3B,MAAM,aAAa,KAAK,sBAAsB;AAE9C,eAAe;IACpB,IAAI;QACF,iCAAiC;QACjC,IAAI,CAAC,cAAc;YACjB,MAAM,UAAU,MAAM,MAAM,GAAG,aAAa,uBAAuB,CAAC,EAAE;gBACpE,SAAS;oBACP,eAAe,eAAe;gBAChC;YACF;YACA,IAAI,CAAC,QAAQ,EAAE,EAAE,MAAM,IAAI,MAAM;YACjC,MAAM,WAAW,MAAM,QAAQ,IAAI;YACnC,IAAI,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,MAAM,GAAG,GAAG;gBAC7C,eAAe,SAAS,IAAI,CAAC,EAAE,CAAC,EAAE;YACpC,OAAO;gBACL,MAAM,IAAI,MAAM;YAClB;QACF;QAEA,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAEpD,kBAAkB;QAClB,MAAM,WAAW,MAAM,MACrB,GAAG,aAAa,kBAAkB,EAAE,aAAa,YAAY,EAAE,MAAM,WAAW,CAAC,EACjF;YACE,SAAS;gBACP,eAAe,eAAe;YAChC;QACF;QAGF,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,YAAY,MAAM,SAAS,IAAI;QAErC,IAAI,CAAC,UAAU,IAAI,IAAI,UAAU,IAAI,CAAC,MAAM,KAAK,GAAG;YAClD,OAAO,iKAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,MAAM;gBACN,SAAS;YACX;QACF;QAEA,MAAM,OAAO,UAAU,IAAI,CAAC,EAAE;QAC9B,MAAM,WAAW,IAAI,KAAK,KAAK,IAAI;QAEnC,OAAO,iKAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,WAAW,KAAK,SAAS,EAAE,aAAa;gBACxC,cAAc,KAAK,YAAY,EAAE,aAAa;gBAC9C,UACE,KAAK,SAAS,EAAE,OAAO,eACnB,KAAK,YAAY,EAAE,YACnB,KAAK,SAAS,EAAE;gBACtB,SAAS,KAAK,SAAS,EAAE,OAAO;gBAChC,QAAQ,KAAK,MAAM,IAAI;gBACvB,mBAAmB,KAAK,GAAG,CACzB,GACA,KAAK,KAAK,CAAC,CAAC,SAAS,OAAO,KAAK,KAAK,GAAG,EAAE,IAAI;YAEnD;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,iKAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO;YACP,MAAM;QACR,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}